<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <title>PuneGo | Smart Micro-Commute Planner</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>
    <script src='https://unpkg.com/@turf/turf@6/turf.min.js'></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary-600: #0F9D58; --primary-700: #0B7B45;
            --secondary-500: #1976d2; --neutral-900: #111827;
            --neutral-700: #374151; --neutral-500: #6b7280;
            --neutral-300: #d1d5db; --neutral-200: #e5e7eb;
            --neutral-100: #f3f4f6; --neutral-0: #ffffff;
            --danger-500: #ef4444;
        }
        * { box-sizing: border-box; }
        html, body, #map {
            height: 100%; margin: 0; padding: 0;
            font-family: 'Inter', sans-serif;
            background-color: var(--neutral-100);
        }
        #map { z-index: 1; }
        .panel {
            position: absolute; top: 1rem; left: 1rem; z-index: 1000;
            background: var(--neutral-0); padding: 1rem; border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
            width: 360px; max-width: calc(100vw - 2rem);
            display: flex; flex-direction: column; gap: 0.75rem;
        }
        .panel-header { font-weight: 700; font-size: 1.125rem; color: var(--neutral-900); }
        .weather-widget {
            padding: 0.5rem; margin-bottom: 0.5rem; border-radius: 0.375rem;
            background-color: var(--neutral-100); font-size: 0.875rem; color: var(--neutral-700);
            text-align: center; display: flex; align-items: center; justify-content: center;
        }
        .input-group { display: flex; gap: 0.5rem; }
        input[type="text"], input[type="number"] {
            width: 100%; padding: 0.625rem; border: 1px solid var(--neutral-300);
            border-radius: 0.375rem; font-size: 0.875rem;
            transition: border-color 0.2s, box-shadow 0.2s;
        }
        input[type="text"]:focus, input[type="number"]:focus {
            outline: none; border-color: var(--secondary-500);
            box-shadow: 0 0 0 3px rgba(25, 118, 210, 0.2);
        }
        .icon-button {
            padding: 0.625rem; border-radius: 0.375rem; border: 1px solid var(--neutral-300);
            cursor: pointer; background: var(--neutral-0); display: flex; align-items: center;
            transition: background-color 0.2s;
        }
        .icon-button:hover { background-color: var(--neutral-100); }
        .icon-button svg { width: 1rem; height: 1rem; stroke: var(--neutral-500); }
        button.primary, button.button-secondary {
            color: white; border: none; font-weight: 600;
            padding: 0.75rem; border-radius: 0.375rem; cursor: pointer;
            transition: background-color 0.2s; display: flex; justify-content: center; align-items: center;
        }
        button.primary { background: var(--primary-600); }
        button.primary:hover { background: var(--primary-700); }
        button.primary:disabled { background: var(--neutral-500); cursor: not-allowed; }
        .parking-container { display: none; border-top: 1px solid var(--neutral-200); padding-top: 0.75rem; }
        button.button-secondary {
            background-color: var(--neutral-0); color: var(--neutral-700);
            border: 1px solid var(--neutral-300); width: 100%;
        }
        button.button-secondary:hover { background-color: var(--neutral-100); }
        .status-text { font-size: 0.875rem; color: var(--neutral-700); min-height: 1.25rem; }
        .route-summary, .route-legend, .poi-controls { border-top: 1px solid var(--neutral-200); padding-top: 0.75rem; }
        .route-legend { display: flex; gap: 1rem; font-size: 0.8125rem; }
        .legend-item { display: flex; align-items: center; gap: 0.375rem; }
        .legend-color-swatch { width: 1rem; height: 0.3125rem; border-radius: 99px; }
        .route-block { margin-bottom: 0.75rem; }
        .route-main { font-size: 0.875rem; }
        .health-metrics { font-size: 0.8125rem; color: var(--neutral-500); padding-left: 0.5rem; }
        .time-saved { color: var(--primary-600); font-weight: 600; font-size: 1rem; }
        .small-link { font-size: 0.8125rem; color: var(--secondary-500); text-decoration: underline; cursor: pointer; }
        .spinner {
            width: 1.25rem; height: 1.25rem; border: 2px solid rgba(255,255,255,0.3);
            border-top-color: var(--neutral-0); border-radius: 50%; animation: spin 1s linear infinite;
        }
        .button-primary.loading .button-text { display: none; }
        .button-primary:not(.loading) .spinner { display: none; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); z-index: 2000; display: flex;
            justify-content: center; align-items: center; opacity: 0;
            visibility: hidden; transition: opacity 0.3s, visibility 0.3s;
        }
        .modal-overlay.visible { opacity: 1; visibility: visible; }
        .modal-content {
            background: white; padding: 2rem; border-radius: 0.75rem;
            max-width: 500px; width: calc(100% - 2rem); position: relative;
            transform: scale(0.95); transition: transform 0.3s;
        }
        .modal-overlay.visible .modal-content { transform: scale(1); }
        .modal-close {
            position: absolute; top: 0.5rem; right: 0.5rem; border: none;
            background: none; font-size: 1.5rem; cursor: pointer; color: var(--neutral-500);
        }
        .poi-controls { display: none; }
        .poi-options { display: flex; flex-wrap: wrap; gap: 1rem; font-size: 0.875rem; }
        .poi-options label { display: flex; align-items: center; gap: 0.375rem; cursor: pointer; }
        .parking-icon {
            background-color: var(--secondary-500); color: white;
            font-size: 16px; font-weight: bold; text-align: center;
            line-height: 20px; border-radius: 50%;
            border: 2px solid white; box-shadow: 0 2px 5px rgba(0,0,0,0.3);
            transition: transform 0.2s ease-in-out;
            cursor: pointer;
        }
        .parking-icon-hover {
            transform: scale(1.2);
        }
    </style>
</head>
<body>
    <div class="panel">
        <div class="panel-header">PuneGo Planner</div>
        <div id="weatherWidget" class="weather-widget"></div>
        <div class="input-group">
            <input id="startInput" type="text" placeholder="Start address" />
            <button id="startBtn" class="icon-button" title="Search for start address">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
            </button>
        </div>
        <div class="input-group">
            <input id="endInput" type="text" placeholder="Destination address" />
            <button id="endBtn" class="icon-button" title="Search for destination address">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line></svg>
            </button>
        </div>
        <div class="input-group">
            <input type="number" id="userWeight" placeholder="Weight (kg)" value="65" style="flex-grow: 0; width: 120px;">
            <span class="small-link" style="text-decoration:none; color: var(--neutral-500); flex-grow: 1;">(For calorie estimate)</span>
        </div>
        <button id="planBtn" class="button-primary">
            <span class="button-text">Find Smart Routes</span>
            <div class="spinner"></div>
        </button>
        <div id="status" class="status-text"></div>
        <div id="routeLegend" class="route-legend"></div>
        <div id="routeSummary" class="route-summary"></div>
        <div id="poiControls" class="poi-controls">
            <div style="font-weight: 600; font-size: 0.8125rem; margin-bottom: 0.5rem;">Show on route:</div>
            <div class="poi-options">
                <label><input type="checkbox" name="poi" value="cafe"> ‚òï Cafes</label>
                <label><input type="checkbox" name="poi" value="restaurant"> üç¥ Restaurants</label>
                <label><input type="checkbox" name="poi" value="fuel"> ‚õΩ Petrol Pumps</label>
                <label><input type="checkbox" name="poi" value="hotel"> üè® Hotels</label>
            </div>
        </div>
        <div id="parkingContainer" class="parking-container">
            <button id="findParkingBtn" class="button-secondary">üÖøÔ∏è Find Parking Near Destination</button>
        </div>
        <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 0.5rem;">
            <span class="small-link" id="clearBtn">Clear All</span>
            <span class="small-link" id="helpBtn">Implementation Notes</span>
        </div>
    </div>
    <div id="map"></div>
    <div id="helpModal" class="modal-overlay">
        <div class="modal-content">
            <button id="modalCloseBtn" class="modal-close">&times;</button>
            <h3>Implementation Notes</h3>
            <ul>
                <li>This prototype uses your API keys directly on the client-side. For production, all API calls should be made through a backend server (proxy) to keep your keys secure.</li>
                <li>Map data layers (traffic signals, POIs, parking) are from OpenStreetMap via the Overpass API.</li>
                <li>This app can be extended by adding real-time data for scooter availability and public transit.</li>
            </ul>
        </div>
    </div>
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="config.js"></script>
    <script src="main.js"></script>
</body>
</html>